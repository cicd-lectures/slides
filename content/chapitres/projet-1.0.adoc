
[{invert}]
= Projet 1.0

Menu de la Cantina de Tatooine

image::cantina.jpg[width=800]

[{invert}]
== Netlify

Fichier `index.html` cherche environment de production pour relation longue durÃ©e

== Rappel

* On a vu comment gÃ©nÃ©rÃ©r du HTML depuis un format Asciidoctor âœ…
* Question: Quel est le livrable final ? Une archive tarball, un fichier `index.html`, un dossier ?

=> DÃ©pends de l'environment de production utilisÃ©

== Production pour du HTML ?

* *But* : hÃ©berger un site web de type statique (HTML+CSS etc.)

* Il faut un service qui permet :
** (MUST) De servir des fichier statiques via HTTP
** (NICE) Active le HTTPS avec des certificats et des noms de domaines

== Say Hello to Netlify

image::Netlify_logo.svg[width=400]

https://www.netlify.com/[]

== Netlify : KÃ©zako ?

* Platforme hÃ©bergÃ©e dans le cloud
* Offres de services gratuites et payantes en fonction des besoins
** L'offre gratuite est suffisante pour notre besoin
* Concept de `git push` -> `netlify build` -> `netlify deploy`
** DÃ©jÃ  vu ?

== PrÃ©paration : CLI Netlify

* Authentifiez-vous sur https://www.netlify.com/[Netlify] (bouton "Log In" puis "GitHub")
** âš ï¸ La 1Ã¨re fois vous devrez autoriser Nelify Ã  accÃ©der Ã  votre compte GitHub

* Dans link:https://gitpod.io#https://github.com/cicd-lectures/demoapp[l'environnement GitPod,window=_blank],
retournez dans `/workspace/exercice-makefile`

* Initialisez l'environnement pour utiliser la CLI Netlify :
** `netlify login` (https://docs.netlify.com/cli/get-started/#obtain-a-token-via-the-command-line[Documentation,window=_blank])
*** Si besoin, choissez "Ouvrir dans une nouvelle fenÃªtre"
** `netlify status` (https://cli.netlify.com/commands/status[Documentation,window=_blank])
** `netlify sites:list` (https://cli.netlify.com/commands/sites[Documentation,window=_blank])

== CrÃ©er un site avec la CLI Netlify

* CrÃ©ez un nouveau "site" en suivant les Ã©tapes suivantes avec la commande `netlify site:<xxx>` :
** `netlify sites:list` (https://cli.netlify.com/commands/sites[Documentation,window=_blank])
** `netlify sites:create` (https://cli.netlify.com/commands/sites[Documentation,window=_blank])
*** Laissez l'option "Site Name" Ã  vide pour obtenir un nom alÃ©atoire

* Configurez les variables d'environnements pour Netlify:
** `export NETLIFY_AUTH_TOKEN=XXX` (rÃ©cupÃ©rez `XXX` dans le fichier `~/.netlify/config.json`)
** `export NETLIFY_SITE_ID=YYY` (rÃ©cupÃ©rez `YYY` Ã  l'aide de la commande `netlify sites:list`)

== DÃ©ployez un site avec la CLI Netlify

* DÃ©ployez le dossier courant (`./`) contenant au moins un fichier `index.html` dans ce nouveau site
** `netlify deploy --dir=./dist/` (https://cli.netlify.com/commands/deploy[Documentation,window=_blank])
** PrÃ©visualisez le site "brouillon" (ğŸ‡¬ğŸ‡§ "Draft")
** `netlify deploy --prod --dir=./dist/` (https://cli.netlify.com/commands/deploy[Documentation,window=_blank])

* Testez le processus complet:
** Modifiez le contenu de `index.adoc`
** RegÃ©nÃ©rez le HTML avec la commande `make all`
** Re-dÃ©ployez le site sur Netlify et vÃ©rifiez que votre changement est prÃ©sent

== Github Actions vs. Netlify

* Netlify est une forme de CI/CD spÃ©cialisÃ©, et Github Actions peut aussi pousser dans Netlify (CLI, etc.)
* Lequel choisir ?
** La question elle est vite rÃ©pondue jeune Ã©tudiant-entrepreneur : Github Actions
** Pourquoi ? Pour rester homogÃ¨nes et bÃ©nÃ©ficier des outils de GitHub

* Github Actions Marketplace : https://github.com/marketplace[]
** Actions Netlify officielle ? ğŸ’¡ https://github.com/netlify/actions/tree/master/cli[]
** Alternative (non officielle) https://github.com/marketplace/actions/netlify-actions[]

== Projet 1.0 : Consignes

=> âŒšï¸ Il est temps pour vous de tout assembler

* Nous sommes en 2021 et vous tenez la Cantina de Tatooine: COVID, commandes par tÃ©lÃ©phone, etc. ğŸ¤’ ğŸ›µ
[.small]
** Ou le Chaudron Baveur du Chemin de Traverse, le Poney Fringuant Ã  Bree, ou mÃªme Paul Bocuse si vous ne vous sentez pas l'Ã¢me imaginaire !

* Votre projet c'est de dÃ©livrer site web contenant le menu de la Cantina

* Le code source sera hÃ©bergÃ© au format Asciidoctor sur un dÃ©pÃ´t +++<span class="fab fa-github"></span>+++ GitHub

* Le site web de votre Cantina sera hÃ©bergÃ© sur... ğŸ¥ ... image:Netlify_logo.svg[height=30,opts=inline] Netlify (surprise!)

* Votre mission si vous l'acceptez : Ã©crire un workflow github qui met en production
Ã  chaque fois qu'un changement est poussÃ© sur main. ğŸš€

[.notes]
--
* Si vous Ãªtes joueurâ€¢se vous pouvez essayer https://gohugo.io/getting-started/quick-start/[Markdown + `hugo`]
--
