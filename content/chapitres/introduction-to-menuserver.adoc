[{invert}]
= Pr√©sentation de votre projet

== Contexte (1/2)

* Dans un effort d'optimisation de ses processus m√©tiers, la cantina de Mos-Estafette s'est lanc√©e dans un grand projet de digitalisation de la gestion de sa carte

* Le projet est divis√© en deux lots:
** Une partie serveur qui stocke et expose la donn√©es de la carte via une API REST
** Une partie client qui permet de consulter et de g√©rer les menus de la cantina via l'API du serveur

== Contexte (2/2)

* Apr√®s une longue et √©pique bataille de chefs de projets et autres d√©cideurs fonctionnels, la soci√©t√© **Bananes Services d'Entreprises**, sp√©cialiste national des technologies du minitel, √† remport√© le lot de la partie serveur...
* ...Cependant, suite √† d'un **grave accident de brainstorming** entre les 18 chefs de projet travaillant sur le dit projet et 6 mois de retard sur la premi√®re livraison, l'entreprise *Bananes* s'est retrouv√©e dans l'incapacit√© de mener le projet √† son terme
* D√©sempar√©s face √† cette terrible nouvelle, le conseil d'administration de la cantina √† d√©cid√© de se tourner vers l'ENSG pour tenter de sauver leur transition num√©rique

== Prise en Main du Projet (1/2)

* Une √©quipe technique de **Bananes** avait commenc√© l'impl√©mentation du serveur, et √† fourni une archive link:media/menu-server.tar.gz[t√©l√©chargeable ICI], contenant le code source du projet
* **Bananes** vous assure qu'ils ont suivi toutes les "best practices" du d√©veloppement logiciel sur minitel
** Il y √† un `LISEZMOI.txt` √† la racine du projet :tada:
** ... et pas grand chose d'autre?

== Prise en Main du Projet (2/2)

[source,bash]
--
# Cr√©ation du r√©pertoire menu-server
mkdir -p /workspace/menu-server && cd /workspace/menu-server

# T√©l√©chargez le projet sur votre environnement de d√©veloppement
curl -sSLO https://cicd-lectures.github.io/slides/2023/media/menu-server.tar.gz

# D√©compresser et extraire l'archive t√©l√©charg√©e
tar xvzf ./menu-server.tar.gz
--

A partir de la vous pouvez ouvrir le fichier `LISEZMOI.txt` et commencer √† suivre ses instructions.

== Comment acc√©der √† un serveur d√©marr√© dans un Gitpod ?

* Vous avez probablement d√©marr√© un serveur web qui √©coute sur  le port 8080
* Si vous souhaitez acc√©der par `curl` depuis terminal de votre gitpod, rien √† faire
* Si vous souhaitez y acc√©der depuis l'ext√©rieur de votre gitpod il vous faut une URL publique:
** `gp url 8080` vous indique l'URL du port 8080 de votre instance gitpod!
** `gp preview "$(gp url 8080)"` ouvrir votre navigateur.

[{invert}]
== Qu'est-ce qui va / ne va pas dans ce projet d'apr√®s vous?

== Triste Rencontre avec la R√©alit√©

- Pas de gestion de version...
- Le projet ne fonctionne pas, tous les menus retourn√©s s'appellent "TODO" :sob:
- Le correctif ne semble pas compliqu√© √† faire...
- ... sauf que vous ne pouvez pas compiler le projet!

Il va falloir rem√©dier √† √ßa d'une fa√ßon ou d'une autre, sinon vous n'allez pas aller bien loin!

== Architecture du projet

image::architecture.png[]

== HTTP Layer

* Fait la transition entre une requ√™te HTTP et une action logique de l'application
* Accepte en entr√©e une requ√™te HTTP (headers, query parameters, verb, (JSON) body)
* R√©ponds un code de statut, des headers et optionnellement un body
* Appelle la couche service en passant des DTOs (data transfer objects)

== Business Layer

* Impl√©mente la logique m√©tier de l'application
* Accepte en entr√©e des DTOs et en r√©ponds en sortie
* Appelle d'autre services ou les repositories de l'application en leur passant des objets model

== Storage Layer

* Fait la transition entre le mod√®le objet java et le mod√®le de la base de donn√©es (ici relationnel // SQL)
* Accepte en entr√©e des objets du mod√®le, et peut en r√©pondre aussi
* Chaque m√©thode impl√©ment√©e par un repository est en r√©alit√© une requ√™te √† votre base de donn√©es
* Impl√©mentation ici d√©l√©gu√©e √† un outil d'ORM (object relational mapping), ici hibernate
* On utilisera dans le cadre de ce cours une base de donn√©e in-memory appel√©e link:https://www.h2database.com/html/main.html[h2]

== Architecture: r√©sum√©

image::architecture.png[]

== Mod√®le de donn√©es

* Une entit√© `Menu`, portant un identifiant et un titre
* Une entit√© `Dish`, portant un identifiant et un titre
* Un `Menu` est compos√© de 0 √† N `Dish`

== Organisation du Code Source

Toutes les classes sont cr√©√©es dans un sous r√©pertoire de `src/main/java/com/cicdlectures/menuserver`

Le d√©coupage est le suivant:

- `controller`: Couche d'interconnection entre HTTP et le domaine m√©tier
- `dto` (Data Transfer Objects): Repr√©sentation interm√©diaire de la donn√©e
- `service`: Couche m√©tier
- `repository`: Couche d'acc√®s a la base de donn√©es
- `model`: Repr√©sentation de votre mod√®le de donn√©e, configuration de l'ORM.

== üéì Exercice : Initialisez un d√©p√¥t git

* Nettoyez le contenu superflu du projet et initialisez un d√©p√¥t git dans le r√©pertoire, puis cr√©ez un premier commit

* Par contenu superflu, nous entendons:
** Tout ce qui est potentiellement g√©n√©r√©
** Les scripts de lancement obsol√®tes et inutiles
** Un petit renommage du LISEZMOI.txt en README.md et un coup de nettoyage de son contenu

* üí° Pour chaque "popup" de l'√©diteur (en bas √† droite), choisissez "Oui" ou "Reload"

== ‚úÖ Solution Exercice

[source,bash]
--
# On √©vacue le contenu inutile
rm -rf dist/ menu-server.tar.gz
rm executer.sh
# On renomme LISEZMOI.txt en README.md
mv LISEZMOI.txt README.md
# On nettoie son contenu
code README.md

# On initialise un nouveau d√©p√¥t git
git init

# On ajoute tous les fichiers contenus a la zone de staging.
git add .

# On cr√©e un nouveau commit
git commit -m "Add initial menu-server project files"
--

== Checkpoint üéØ

* Vous avez r√©cup√©r√© un projet Java qui semble fonctionner...
** ..mais pas vraiment √† l'√©tat de l'art.

* Application du chapitre pr√©c√©dent : vous avez initialis√© un projet `git` local
