[{invert}]
= Rappels de Programation Orient√©e Objet

== Java (toujours) bien?

* Java est un langage orient√© objet (OO)
* Consiste en la d√©finition et l'int√©raction de briques logicielles
* Briques logicielles qu'on appelle... des Objets!

== Anatomie d'une brique (1/2)

Un objet est compos√© de:

* D'un ou plusieurs attributs: *son √©tat*
* D'une ou plusieurs methodes: *ses actions*

== Anatomie d'une brique (2/2)

* Exemple: un coffre
** Attributs:
*** La liste des objets contenus,
*** Est-ce qu'il est ouvert ou ferm√©?:
** Methodes:
*** Ouvrir le coffre,
*** Fermer le coffre,
*** Ajouter un objet dans le coffre
*** Retirer un objet du coffre

== Definition d'une brique en Java

Pour definir une brique logicielle on declare et implemente une `classe`

== Cycle de vie d'une brique

Definir et implementer c'est pas suffisant, il faut aussi l'instantier et la detruire.

Dire qu'un objet nouvellement instantie doit etre toujours utilisable.
Comment initialiser un objet?

== Constructeurs

Initialise un Objet pour qu'il soit utilisable
Il peut y avoir un ou plusieurs constructeurs.
Peut accepter des parametres, on parle alors de dependances.

== Visibilite des symboles d'une classe

Rappel public protected private
Quel but? Encapsulation. Faire en sorte que votre brique soit toujours utilisee correctement.
Exemple du coffre: si la collection est publique ajouter un objet sans que le coffre soit ouvert

== Exercice: Implementez la classe coffre

Implementez une classe coffre qui expose les methodes suivantes:

* Ouvrir le coffre
* Fermer le coffre
* Ajouter un Objet dans le coffre, si le coffre est ouvert
* Enlever un Objet du coffre, si le coffre est ouvert

Pensez a l'initialisation, ecrivez un main qui teste les differents comportements de votre coffre. Vous devez definir plus qu'une seule classe.

== Anatomie d'une Application Java

* ... une collection de briques logicielles assembl√©es!
* Certaines deja impl√©ment√©es pour vous: *le framework*
* Certaines a definir et implementer vous meme: *le code metier*

== Framework utilise: Spring

Fournis une collection d'outils pour ecrire un serveur web, par exemple:

* Serveur HTTP
* Communication avec une base donnees
* Injection de dependances

Tout cela est deja fourni, vous n'avez pas a le reimplementer, juste a l'utiliser.

== Organisation du code metier avec Spring

Spring encourage aussi a orgaiser son code en couches

image::architecture.png[]

== Couche HTTP

* Fait la transition entre une requ√™te HTTP et une action logique de l'application
* Accepte en entr√©e une requ√™te HTTP (headers, query parameters, verb, (JSON) body)
* R√©ponds un code de statut, des headers et optionnellement un body
* Appelle la couche service en passant des DTOs (data transfer objects)

== Couche Metier

* Impl√©mente la logique m√©tier de l'application
* Accepte en entr√©e des DTOs et en r√©ponds en sortie
* Appelle d'autre services ou les repositories de l'application en leur passant des objets model

== Couche Stockage

* Fait la transition entre le mod√®le objet java et le mod√®le de la base de donn√©es (ici relationnel // SQL)
* Accepte en entr√©e des objets du mod√®le, et peut en r√©pondre aussi
* Chaque m√©thode impl√©ment√©e par un repository est en r√©alit√© une requ√™te √† votre base de donn√©es
* Impl√©mentation ici d√©l√©gu√©e √† un outil d'ORM (object relational mapping), ici hibernate
* On utilisera dans le cadre de ce cours une base de donn√©e en memoire appel√©e link:https://www.h2database.com/html/main.html[h2]

== Different types de briques

- Les `controllers`: Couche d'interconnection entre HTTP et le domaine m√©tier
- Les `dtos` (Data Transfer Objects): Repr√©sentation interm√©diaire de la donn√©e
- Les `services`: Couche m√©tier
- Les `repositories`: Couche d'acc√®s a la base de donn√©es
- Les `models`: Repr√©sentation de votre mod√®le de donn√©e, configuration de l'ORM.

Vous pouvez retrouver cette organisation dans le r√©pertoire `src/main/java/com/cicdlectures/menuserver`

== Architecture: r√©sum√©

image::architecture.png[]

== Mod√®le de donn√©es

* Une entit√© `Menu`, portant un identifiant et un titre
* Une entit√© `Dish`, portant un identifiant et un titre
* Un `Menu` est compos√© de 0 √† N `Dish`

== TODO exercice ici !?

Petit car ils ont le Delete au chapitre suivant.

== Checkpoint üéØ

* La programation orient√©e objet c'est une histoire de briques qui interagissent entre elles.
* Une application Java, c'est une collection de briques, certaines deja fournies, d'autres que vous implementez vous meme
* Une application Spring oblige une certaine structure
